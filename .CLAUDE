# Project Context for AI Assistants

## Project Overview
This is a personal portfolio website with blog functionality built using Gatsby and React.

## Current State
- **Framework**: Gatsby (React-based static site generator)
- **Styling**: styled-components with reactstrap (Bootstrap)
- **TypeScript**: Recently implemented - types are not fully added to all components yet
- **Content**: Portfolio projects with image galleries, blog posts, skills, contact info

## Migration Goals

### Primary Goal: Migrate from Gatsby to Astro
We are **aiming to make net-negative changes** (simplify the codebase) to eventually convert this site to use Astro instead of Gatsby.

**Why Astro?**
- Better performance with islands architecture
- Less JavaScript shipped to the client
- Simpler build process
- Better TypeScript support out of the box
- More flexible content handling

**Migration Strategy**:
- Prefer simpler, more portable solutions when fixing or adding features
- Avoid adding complex Gatsby-specific dependencies
- Keep components as vanilla React as possible
- Document any Gatsby-specific features that will need replacement

### CSS Variables Migration Path (Hybrid Approach)

**Current State**: styled-components with SCSS for some components
**Target State**: CSS variables for theme values + hybrid component styling

**Migration Path** (incremental, can be done over time):

#### Phase 1: Foundation (Do this first)
1. Create `src/styles/` directory with:
   - `variables.css` - CSS custom properties for all theme values
   - `globals.css` - Global styles that consume CSS variables

2. Define CSS variables matching current theme:
```css
:root {
  /* Colors - matching current theme */
  --color-white: #ffffff;
  --color-black: #000000;
  --color-primary: #3e64ff;        /* Current blue */
  --color-secondary: #a0f669;      /* Current green */
  --color-text-muted: #666666;     /* Subheader/secondary text */
  --color-slate-100: #f1f5f9;
  --color-slate-200: #e2e8f0;

  /* Header states */
  --header-bg-transparent: transparent;
  --header-bg-scrolled: rgba(255, 255, 255, 0.8);
  --header-bg-menu-open: rgba(255, 255, 255, 0.95);

  /* Transitions */
  --transition-colors: 300ms ease-in-out;

  /* Z-index */
  --z-header: 100;
}

[data-theme="dark"] {
  --color-white: #0a0a0a;
  --color-black: #ffffff;
  --header-bg-scrolled: rgba(10, 10, 10, 0.8);
  --header-bg-menu-open: rgba(10, 10, 10, 0.95);
}
```

3. Import `globals.css` in `src/components/Layout.tsx` or `gatsby-browser.tsx`

#### Phase 2: Header Refactor (Current task)
- Refactor Nav component to use CSS classes with CSS variables
- Keep hamburger button as styled-component consuming CSS variables
- Add scroll and menu state logic

#### Phase 3: Gradual Component Migration
When working on components, choose based on complexity:

**New components or major refactors:**
- Create component folder: `ComponentName/`
  - `ComponentName.tsx` - Component logic (export directly)
  - `ComponentName.module.css` - Component styles using CSS variables
- Export directly from the component file, skip index.ts unless re-exporting multiple files

**Simple updates to existing components:**
- Keep styled-components
- Update to consume CSS variables via `var(--variable-name)`
- Example: `color: var(--color-primary);`

#### Phase 4: Dark Mode Foundation
- Add `[data-theme="dark"]` variables to `variables.css`
- Add theme toggle in Layout or Navigation
- Components using CSS variables automatically support dark mode

#### Phase 5: Astro Migration (Future)
- CSS modules (`.module.css`) work natively in Astro
- CSS variables work everywhere
- Convert React components to Astro components incrementally
- Keep interactive components as React islands

**To trigger this migration**: Say "begin CSS variables migration" or work on specific components incrementally.

## Pending Design Tasks (Original Plan from Brainstorming Session)

### Header Refactor with Glassmorphism Effect
**Goal**: Refactor the Header component to handle scroll and mobile menu states consistently

**Requirements**:
1. **Initial State**: Transparent background, sticky at top-0
2. **Scroll Logic**: Use scroll listener. If window.scrollY > 20, add bg-white/80 and backdrop-blur-md with border-b border-slate-100
3. **Mobile/Medium Menu Fix**: Add state isMenuOpen. If true, header background becomes bg-white/95 (solid) regardless of scroll position
4. **Z-Index**: Header has z-[100], mobile menu has matching background
5. **Transition**: Apply transition-colors duration-300 to header wrapper

### Section Content Changes
1. **"What I Do" â†’ "Core Expertise"** (rename section header)
2. **Add subheaders**:
   - Core Expertise: "Bridging the gap between complex technical architecture and scalable business solutions."
   - Experience: "A proven track record of engineering excellence at industry-leading organizations."
3. **Style adjustments for Skills/Core Expertise section**:
   - "Full Stack Development" and "AI & Systems Engineering": Bold â†’ Medium font weight
   - Increase space above these two titles

## Code Quality Guidelines

### TypeScript
- TypeScript was recently implemented
- **Action Required**: Add proper types and interfaces to components when working on them
- Convert `any` types to proper interfaces
- Add return types to functions
- Use proper typing for props, state, and component definitions

### Simplification Principles
1. **Net-negative changes**: When fixing bugs or adding features, try to remove more code than you add
2. **Reduce dependencies**: Prefer standard React patterns over library-specific solutions
3. **Avoid over-engineering**: Keep solutions simple and maintainable
4. **Framework-agnostic**: Write code that will be easier to migrate to Astro

### Component Structure
- Functional components preferred (already in use)
- Use React hooks for state management
- Keep styled-components usage (works with Astro)
- Minimize Gatsby-specific APIs (GraphQL queries, gatsby-image, etc.)

## Current Technical Debt

### Known Issues
1. **Lightbox Library**: âœ… **RESOLVED** - Migrated to `yet-another-react-lightbox` (v3.28.0)
   - Previously used `react-image-lightbox` (archived since Jan 2023)
   - Fixed: Ctrl+Zoom no longer closes the lightbox
   - Added proper zoom functionality with Zoom plugin
   - Configuration: maxZoomPixelRatio: 3, zoomInMultiplier: 2, scrollToZoom: true

2. **TypeScript Coverage**: Not all components have proper types
   - Props often use `any` type
   - Missing interfaces for data structures
   - No return type annotations on many functions

3. **Gatsby-Specific Code**: Heavy reliance on Gatsby APIs
   - GraphQL queries for content
   - gatsby-plugin-image for image optimization
   - Gatsby routing and page generation

## Development Priorities

1. **Maintainability**: Choose solutions that are actively maintained
2. **Portability**: Prefer solutions that work outside Gatsby ecosystem
3. **Simplicity**: Less code is better code
4. **Type Safety**: Add TypeScript types when touching components
5. **Performance**: Keep bundle size small

## Working with This Codebase

### When Adding Features
- Check if a simpler solution exists before adding dependencies
- Consider how it will migrate to Astro
- Add TypeScript types
- Aim for net-negative code changes

### When Fixing Bugs
- Look for opportunities to simplify while fixing
- Remove unused code
- Add proper types
- Document any Gatsby-specific workarounds

### When Reviewing Dependencies
- Check if dependency is actively maintained
- Consider if it's needed or if native browser APIs suffice
- Prefer framework-agnostic libraries
- Document alternatives for future migration

## Detailed Project Structure

### File Organization
```
src/
â”œâ”€â”€ components/               # React components (modular)
â”‚   â”œâ”€â”€ About/               # About section component
â”‚   â”œâ”€â”€ Contact/             # Contact form component
â”‚   â”œâ”€â”€ Footer/              # Footer component
â”‚   â”œâ”€â”€ Introduction/        # Hero section with SVG illustration
â”‚   â”‚   â”œâ”€â”€ Introduction.tsx # Main component
â”‚   â”‚   â”œâ”€â”€ style.ts         # Styled components (HeroWrap, Slider, etc.)
â”‚   â”‚   â”œâ”€â”€ Mouse.tsx        # Animated arrow component
â”‚   â”‚   â””â”€â”€ resume.pdf       # Resume file
â”‚   â”œâ”€â”€ Layout.tsx           # Page wrapper component
â”‚   â”œâ”€â”€ Navigation/          # Header navigation
â”‚   â”œâ”€â”€ Projects/            # Projects section
â”‚   â”‚   â”œâ”€â”€ Projects.tsx     # Container component
â”‚   â”‚   â”œâ”€â”€ Project.tsx      # Individual project card with modal & lightbox
â”‚   â”‚   â””â”€â”€ style.ts         # Styled components (ProjectWrapper, etc.)
â”‚   â”œâ”€â”€ SEO.tsx              # SEO metadata component
â”‚   â”œâ”€â”€ Skills/              # Skills showcase component
â”‚   â”œâ”€â”€ Social.tsx           # Social media links component
â”‚   â”œâ”€â”€ main.ts              # Main initialization script
â”‚   â””â”€â”€ style.ts             # Global theme and styled components
â”‚
â”œâ”€â”€ data/                    # JSON content files
â”‚   â”œâ”€â”€ introduction.json    # Hero section text and titles
â”‚   â”œâ”€â”€ favicon.png          # Site favicon
â”‚   â””â”€â”€ projects/            # Project data (one folder per project)
â”‚       â””â”€â”€ {project-name}/  # e.g., whatspython, promptbuilder
â”‚           â”œâ”€â”€ project.json # Project metadata, images, links
â”‚           â””â”€â”€ images/      # Gallery images for the project
â”‚
â”œâ”€â”€ pages/                   # Gatsby pages (auto-routed)
â”‚   â”œâ”€â”€ index.tsx            # Homepage (/) - Main landing page
â”‚   â”œâ”€â”€ projects.tsx         # Projects page (/projects)
â”‚   â””â”€â”€ blog.tsx             # Blog listing page (/blog)
â”‚
â”œâ”€â”€ templates/               # Gatsby templates for generated pages
â”‚   â””â”€â”€ BlogPost.tsx         # Individual blog post template
â”‚
â””â”€â”€ styles/                  # Global CSS (if any)

gatsby-config.js             # Gatsby configuration
gatsby-node.js               # Dynamic page generation
package.json                 # Dependencies and scripts
tsconfig.json                # TypeScript configuration
```

### Component Architecture Patterns

#### 1. **Component + Style Pattern**
Most components follow this structure:
- `ComponentName.tsx` - React component logic
- `style.ts` - Styled-components definitions exported for use

Example:
```typescript
// Projects/Project.tsx
import { ProjectWrapper, ReadMoreColor } from './style.ts'

// Projects/style.ts
export const ProjectWrapper = styled.div`...`
export const ReadMoreColor = styled.div`...`
```

#### 2. **Modal + Lightbox Pattern** (Projects)
- Modal: Reactstrap `<Modal>` component for project details
- Carousel: `react-responsive-carousel` for image browsing
- Lightbox: `yet-another-react-lightbox` with Zoom plugin for fullscreen image viewing
- State management: Multiple `useState` hooks for modal, lightbox, and photoIndex

**Key Components:**
- `/src/components/Projects/Project.tsx` - Contains modal and lightbox implementation
- Uses `GatsbyImage` for optimized images with fallback to `<img>`

**Lightbox Configuration:**
```typescript
<Lightbox
  open={lightboxOpen}
  close={() => setLightbox(false)}
  slides={images.map(src => ({ src }))}
  index={photoIndex}
  plugins={[Zoom]}
  zoom={{
    maxZoomPixelRatio: 3,
    zoomInMultiplier: 2,
    scrollToZoom: true
  }}
  on={{
    view: ({ index }) => setPhotoIndex(index)
  }}
  styles={{ container: { zIndex: 1100 } }}
/>
```

#### 3. **Data Flow**
```
JSON files (src/data/)
  â†’ GraphQL queries (useStaticQuery or page queries)
  â†’ Component props
  â†’ Rendered UI
```

Example from Introduction component:
```typescript
const data = useStaticQuery(graphql`
  query {
    introduction {
      greeting, name, role, descriptions { ... }
    }
  }
`);
```

### Styling Architecture

#### Global Theme (`src/components/style.ts`)
```typescript
export const theme = {
  primaryColor: '#3e64ff',     // Blue
  secondaryColor: '#a0f669',   // Green
  black: '#2d3748',
  white: '#ffffff',
  darken: '#718096'
}
```

#### Responsive Breakpoints
- Uses Bootstrap/reactstrap grid system
- Common breakpoint: `@media (max-width: 767.98px)` for mobile

#### Styled Components Usage
- Global styles: `Body`, `theme` exported from `src/components/style.ts`
- Component-specific: Each component has its own `style.ts`
- Animations: Uses `react-animated-css` for fade-in effects

### Key Dependencies

#### Core Framework
- **gatsby**: Static site generator
- **react** + **react-dom**: UI library
- **typescript**: Type safety

#### Styling
- **styled-components**: CSS-in-JS styling
- **reactstrap** (Bootstrap 5): UI components (Modal, Button, etc.)
- **react-animated-css**: Animation library

#### Images
- **gatsby-plugin-image**: Optimized image loading
- **gatsby-plugin-sharp**: Image processing
- **gatsby-source-filesystem**: File system data source

#### Content & Data
- **GraphQL**: Data querying (Gatsby's built-in)
- **remark**: Markdown processing for blog posts

#### UI Components
- **react-responsive-carousel**: Image carousels
- **yet-another-react-lightbox**: Modern lightbox gallery with zoom plugin (replaced react-image-lightbox)
- **react-icons**: Icon library (FontAwesome, Ionicons, etc.)
- **@caseykey/react-read-more-read-less**: Expandable text
- **react-waypoint**: Scroll-based visibility detection
- **typewriter-effect**: Typing animation in hero section

#### Forms
- **formik**: Form state management
- **react-google-recaptcha**: CAPTCHA protection

### Routing & Navigation

#### Page Routes (Auto-generated by Gatsby)
- `/` - Homepage (src/pages/index.tsx)
- `/projects` - Projects listing (src/pages/projects.tsx)
- `/blog` - Blog listing (src/pages/blog.tsx)
- `/blog/{slug}` - Individual blog posts (generated from templates)

#### Navigation Component
Located at `src/components/Navigation/`
- Uses reactstrap `Navbar` component
- Links: Home, Resume, Blog, About, Projects, Contact

### Common Patterns Found

#### 1. **Animation Pattern**
```typescript
const [visible, setVisible] = useState(false);
const makeVisible = () => setVisible(true);

<Animated animationIn="fadeInUp" isVisible={visible}>
  <Waypoint onEnter={makeVisible} />
  {/* Content */}
</Animated>
```

#### 2. **Icon Rendering Pattern**
Icons are passed as components from GraphQL:
```typescript
icons.map((Icon, index) => (
  <Icon size={21} key={index} />
))
```

#### 3. **Image Handling Pattern**
Dual support for optimized and fallback images:
```typescript
image.childImageSharp
  ? <GatsbyImage image={image.childImageSharp.gatsbyImageData} />
  : <img src={image.publicURL} />
```

#### 4. **Modal Toggle Pattern**
```typescript
const [modal, setModal] = useState(false);
const toggleModal = () => setModal(!modal);
```

### Project Data Structure

Example: `src/data/projects/whatspython/project.json`
```json
{
  "title": "Project Name",
  "subtitle": "Short description",
  "date": "YYYY-MM-DD",
  "image": { /* GatsbyImage reference */ },
  "galleryImages": [
    { "image": { /* path or reference */ } }
  ],
  "icons": {
    "fa": ["FaPython", "FaReact"],
    "si": ["SiTypescript"]
  },
  "link": "https://external-link.com",
  "postLink": "/blog/project-post"
}
```

### Build & Development Scripts
Corrected package.json scripts for Gatsby (previously had incorrect react-scripts references):
```json
{
  "develop": "gatsby develop",
  "start": "gatsby develop",
  "build": "gatsby build",
  "serve": "gatsby serve",
  "clean": "gatsby clean",
  "predeploy": "gatsby build",
  "deploy": "gh-pages -d public -b master"
}
```

### Git Workflow Notes
- Branch: `source` (main development branch)
- Recent commits show incremental improvements
- Commits co-authored with Claude Opus 4.5

## Development Commands

### Starting Dev Server
```bash
yarn develop
# or: npm run develop
```
This starts the Gatsby development server with hot-reloading using auto-port selection, which tries ports 8001-8008 in sequence until one is available, without requiring terminal input.

**Note**: The dev command uses `-H 0.0.0.0` to bind to all network interfaces for auto-port selection.

### Worktree Development
When working in a git worktree (e.g., `.worktrees/portfolio-enhancement`):
```bash
# Navigate to worktree
cd .worktrees/portfolio-enhancement

# Start dev server on alternative port
gatsby develop -p 8003

# Open in browser
# Server will be at http://localhost:8003/
```

Worktrees are isolated workspaces that share the git repository. Changes made in a worktree don't affect your main branch until merged.

### Creating a New Worktree
When starting a new feature, create a worktree for isolation:
```bash
# From the base folder (main branch), create a new worktree with feature branch
git worktree add .worktrees/feature-name -b feature-name

# Navigate to worktree and start working
cd .worktrees/feature-name
yarn develop
```

**Important:** AI agents should work in worktrees and use feature branches when appropriate. This keeps the main branch clean and allows for isolated development and testing before merging.

### Pushing Changes to Remote
Feature branches must be pushed periodically to make them available in the remote origin:
```bash
# From within the worktree
git push -u origin feature-name

# Push subsequent changes
git push
```

This ensures:
- Changes are backed up remotely
- Feature branches are available for code review
- CI/CD pipelines can run on the feature branch
- Team members can access and test the feature

### Building for Production
```bash
yarn gatsby build
```

### Running Tests
No test suite is currently configured for this project.

---

## ğŸ“ Maintenance Instructions for AI Assistants

**IMPORTANT**: This `.CLAUDE` file is a living document. As you work on this codebase:

1. **After exploring new areas**, add findings here:
   - Component patterns you discovered
   - Data structures and their locations
   - Common bugs or gotchas
   - Useful file locations for specific tasks

2. **After implementing features**, document:
   - New dependencies and why they were chosen
   - Architecture decisions made
   - Migration-relevant notes (Gatsby â†’ Astro)

3. **Keep it organized**:
   - Update existing sections rather than adding duplicates
   - Use clear headings and examples
   - Focus on information that helps locate and modify code quickly

4. **Prioritize actionable information**:
   - "Where to find X" over "How X works in theory"
   - Specific file paths and line number ranges
   - Common patterns with code examples

**This file is your project memory** - treat it as a knowledge base that grows with each interaction.

---

## Contact
This file should be updated as the codebase evolves and migration plans solidify.
